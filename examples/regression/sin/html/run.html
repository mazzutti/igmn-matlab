<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<META http-equiv="Content-Type" content="text/html; charset=UTF-8">
<!--
This HTML was auto-generated from MATLAB code.
To make changes, update the MATLAB code and republish this document.
      -->
<title>run</title>
<meta name="generator" content="MATLAB 24.1">
<link rel="schema.DC" href="http://purl.org/dc/elements/1.1/">
<meta name="DC.date" content="2025-04-13">
<meta name="DC.source" content="run.m">
<style type="text/css">
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{margin:0;padding:0;border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent}body{line-height:1}ol,ul{list-style:none}blockquote,q{quotes:none}blockquote:before,blockquote:after,q:before,q:after{content:'';content:none}:focus{outine:0}ins{text-decoration:none}del{text-decoration:line-through}table{border-collapse:collapse;border-spacing:0}

html { min-height:100%; margin-bottom:1px; }
html body { height:100%; margin:0px; font-family:Arial, Helvetica, sans-serif; font-size:10px; color:#000; line-height:140%; background:#fff none; overflow-y:scroll; }
html body td { vertical-align:top; text-align:left; }

h1 { padding:0px; margin:0px 0px 25px; font-family:Arial, Helvetica, sans-serif; font-size:1.5em; color:#d55000; line-height:100%; font-weight:normal; }
h2 { padding:0px; margin:0px 0px 8px; font-family:Arial, Helvetica, sans-serif; font-size:1.2em; color:#000; font-weight:bold; line-height:140%; border-bottom:1px solid #d6d4d4; display:block; }
h3 { padding:0px; margin:0px 0px 5px; font-family:Arial, Helvetica, sans-serif; font-size:1.1em; color:#000; font-weight:bold; line-height:140%; }

a { color:#005fce; text-decoration:none; }
a:hover { color:#005fce; text-decoration:underline; }
a:visited { color:#004aa0; text-decoration:none; }

p { padding:0px; margin:0px 0px 20px; }
img { padding:0px; margin:0px 0px 20px; border:none; }
p img, pre img, tt img, li img, h1 img, h2 img { margin-bottom:0px; }

ul { padding:0px; margin:0px 0px 20px 23px; list-style:square; }
ul li { padding:0px; margin:0px 0px 7px 0px; }
ul li ul { padding:5px 0px 0px; margin:0px 0px 7px 23px; }
ul li ol li { list-style:decimal; }
ol { padding:0px; margin:0px 0px 20px 0px; list-style:decimal; }
ol li { padding:0px; margin:0px 0px 7px 23px; list-style-type:decimal; }
ol li ol { padding:5px 0px 0px; margin:0px 0px 7px 0px; }
ol li ol li { list-style-type:lower-alpha; }
ol li ul { padding-top:7px; }
ol li ul li { list-style:square; }

.content { font-size:1.2em; line-height:140%; padding: 20px; }

pre, code { font-size:12px; }
tt { font-size: 1.2em; }
pre { margin:0px 0px 20px; }
pre.codeinput { padding:10px; border:1px solid #d3d3d3; background:#f7f7f7; }
pre.codeoutput { padding:10px 11px; margin:0px 0px 20px; color:#4c4c4c; }
pre.error { color:red; }

@media print { pre.codeinput, pre.codeoutput { word-wrap:break-word; width:100%; } }

span.keyword { color:#0000FF }
span.comment { color:#228B22 }
span.string { color:#A020F0 }
span.untermstring { color:#B20000 }
span.syscmd { color:#B28C00 }
span.typesection { color:#A0522D }

.footer { width:auto; padding:10px 0px; margin:25px 0px 0px; border-top:1px dotted #878787; font-size:0.8em; line-height:140%; font-style:italic; color:#878787; text-align:left; float:none; }
.footer p { margin:0px; }
.footer a { color:#878787; }
.footer a:hover { color:#878787; text-decoration:underline; }
.footer a:visited { color:#878787; }

table th { padding:7px 5px; text-align:left; vertical-align:middle; border: 1px solid #d6d4d4; font-weight:bold; }
table td { padding:7px 5px; text-align:left; vertical-align:top; border:1px solid #d6d4d4; }





  </style>
</head>
<body>
<div class="content">
<pre class="codeinput">
<span class="comment">%{
</span><span class="comment">
</span><span class="comment">This script demonstrates the use of Incremental Gaussian Mixture Networks (IGMN)
</span><span class="comment">for regression tasks using sinusoidal data. The script includes data preparation,
</span><span class="comment">parameter tuning, model training, and prediction. It also visualizes the results
</span><span class="comment">and exports the Gaussian components of the trained network.
</span><span class="comment">
</span><span class="comment">Main Steps:
</span><span class="comment">1. Clear workspace, close figures, and set random seed for reproducibility.
</span><span class="comment">2. Add the IGMN library to the MATLAB path.
</span><span class="comment">3. Generate input and output data for the regression task.
</span><span class="comment">4. Define the maximum number of Gaussian components (`maxNc`).
</span><span class="comment">5. Create a `Problem` object to configure the regression task, including:
</span><span class="comment">    - Input and output data.
</span><span class="comment">    - Execution mode (e.g., 'mex' or 'native').
</span><span class="comment">    - Parameter tuning options.
</span><span class="comment">    - Compilation options for optimization.
</span><span class="comment">6. Configure optimization options for hyperparameter tuning, such as:
</span><span class="comment">    - Algorithm type.
</span><span class="comment">    - Self and social adjustment factors.
</span><span class="comment">    - Population size and parallel execution.
</span><span class="comment">    - Tolerance and stopping criteria.
</span><span class="comment">7. Compile the problem if the execution mode is 'mex' or 'native'.
</span><span class="comment">8. Perform parameter tuning if enabled.
</span><span class="comment">9. Train the IGMN model using the training data.
</span><span class="comment">10. Predict the output for test data and evaluate the results.
</span><span class="comment">11. Visualize the regression results and Gaussian components of the trained network.
</span><span class="comment">12. Export the visualization as a PDF file.
</span><span class="comment">
</span><span class="comment">Key Parameters:
</span><span class="comment">- `maxNc`: Maximum number of Gaussian components.
</span><span class="comment">- `ExecutionMode`: Determines whether to use 'mex' or 'native' execution.
</span><span class="comment">- `OptimizeOptions`: Contains settings for hyperparameter optimization.
</span><span class="comment">- `DefaultIgmnOptions`: Default options for the IGMN model.
</span><span class="comment">
</span><span class="comment">Visualization:
</span><span class="comment">- Regression results are plotted using `plotregression`.
</span><span class="comment">- Gaussian components are visualized using `plotNet`.
</span><span class="comment">
</span><span class="comment">Dependencies:
</span><span class="comment">- The script requires the IGMN library and its associated functions
</span><span class="comment">  (e.g., `optimize_mex`, `igmnBuilder_mex`, `train_mex`, `predict_mex`).
</span><span class="comment">
</span><span class="comment">Output:
</span><span class="comment">- Regression performance visualization.
</span><span class="comment">- Exported PDF file showing the Gaussian components of the trained network.
</span><span class="comment">%}
</span>clear <span class="string">all</span>; <span class="comment">%#ok&lt;CLALL&gt;</span>
close <span class="string">all</span>;
clc;
rng(<span class="string">'default'</span>);
rng(42);

addpath(<span class="string">'../../../igmn/'</span>);

inputData = 0:0.01:(2 * pi);
inputData = inputData(randperm(size(inputData, 2)));
outputData = linspace(0, 2 * pi, 100);

maxNc = 7;

problem = Problem( <span class="keyword">...</span>
    [inputData; sin(inputData)]', <span class="keyword">...</span>
    [outputData; sin(outputData)]', <span class="keyword">...</span>
    <span class="string">'ExecutionMode'</span>, <span class="string">'mex'</span>, <span class="keyword">...</span>
    <span class="string">'DoParametersTuning'</span>, false, <span class="keyword">...</span>
    <span class="string">'CompileOptions'</span>, compileoptions(<span class="keyword">...</span>
        size(inputData, 2), size(outputData, 2),  <span class="keyword">...</span>
        <span class="string">'NumberOfVariables'</span>, 2, <span class="keyword">...</span>
        <span class="string">'NumberOfOutputVars'</span>, 1, <span class="keyword">...</span>
        <span class="string">'EnableRecompile'</span>, false, <span class="keyword">...</span>
        <span class="string">'IsOptimization'</span>, true <span class="keyword">...</span>
    ));

<span class="comment">% problem.OptimizeOptions.PlotFcns = {};</span>
problem.OptimizeOptions.Algorithm = <span class="string">'imode'</span>;
problem.OptimizeOptions.SelfAdjustment = 1.49;
problem.OptimizeOptions.SocialAdjustment = 1.49;
problem.OptimizeOptions.UseDefaultsFor = {<span class="string">'MaxNc'</span>, <span class="string">'UseRankOne'</span>};
<span class="comment">% problem.DefaultIgmnOptions.Phi = 1;</span>
problem.OptimizeOptions.MaxFunEval = 100000;
problem.OptimizeOptions.PopulationSize = 30;
problem.OptimizeOptions.UseParallel = true;
problem.OptimizeOptions.StallIterLimit = 200;
problem.OptimizeOptions.TolFunValue = 1e-12;
problem.DefaultIgmnOptions.MaxNc = maxNc;
problem.DefaultIgmnOptions.UseRankOne = 1;
problem.DefaultIgmnOptions.SPMin = 2;
<span class="comment">% problem.DefaultIgmnOptions.Delta = 0.1;</span>
problem.OptimizeOptions.hyperparameters{5}.ub = 6;
problem.OptimizeOptions.hyperparameters{5}.lb = 2;

<span class="keyword">if</span> strcmpi(problem.ExecutionMode, <span class="string">'mex'</span>) || strcmpi(problem.ExecutionMode, <span class="string">'native'</span>)
    compile(problem);
    <span class="keyword">if</span> strcmpi(problem.ExecutionMode, <span class="string">'mex'</span>)
        optimize = @optimize_mex;
        igmnBuilder = @igmnBuilder_mex;
        train = @train_mex;
        predict = @predict_mex;
    <span class="keyword">end</span>
<span class="keyword">end</span>

<span class="keyword">if</span> ~strcmpi(problem.ExecutionMode, <span class="string">'native'</span>)
    <span class="keyword">if</span> problem.DoParametersTuning
        tic;
        igmnOptions = optimize(problem);
        save(<span class="string">'igmnOptions'</span>, <span class="string">'igmnOptions'</span>);
        toc;
    <span class="keyword">else</span>
        igmnOptions = load(<span class="string">'igmnOptions.mat'</span>).igmnOptions;
    <span class="keyword">end</span>

    trainData = problem.trainData;
    testData = problem.testData;
    inputVarIndexes = problem.InputVarIndexes;
    outputVarIndexes = problem.OutputVarIndexes;

    tic;
    net = igmnBuilder(igmnOptions);
    net = train(net, trainData);
    Y = predict(net, testData(:, inputVarIndexes), <span class="keyword">...</span>
        outputVarIndexes, 0, zeros(size(net.range(:, outputVarIndexes))));
    toc;

    figure; plotregression(testData(:, outputVarIndexes), Y);
    figure;
    scatter(inputData + rand(1, size(inputData, 2)) .* 0.2, <span class="keyword">...</span>
        sin(inputData), <span class="string">'Marker'</span>, <span class="string">'.'</span> ,<span class="string">'Color'</span>, [0 0.4470 0.7410]);
    plotNet(net, <span class="string">'sd'</span>, 4.5, <span class="string">'ax'</span>, gca, <span class="string">'sd'</span>, 4);
    exportgraphics( <span class="keyword">...</span>
        gcf, sprintf(<span class="string">'%s.pdf'</span>, <span class="string">'igmn_gaussians'</span>), <span class="keyword">...</span>
        <span class="string">'BackgroundColor'</span>, <span class="string">'none'</span>, <span class="string">'Resolution'</span>, 300)
<span class="keyword">end</span>
</pre>
<pre class="codeoutput">Elapsed time is 0.058427 seconds.
</pre>
<img vspace="5" hspace="5" src="run_01.png" alt=""> <img vspace="5" hspace="5" src="run_02.png" alt=""> <p class="footer">
<br>
<a href="https://www.mathworks.com/products/matlab/">Published with MATLAB&reg; R2024a</a>
<br>
</p>
</div>
<!--
##### SOURCE BEGIN #####
%{

This script demonstrates the use of Incremental Gaussian Mixture Networks (IGMN) 
for regression tasks using sinusoidal data. The script includes data preparation, 
parameter tuning, model training, and prediction. It also visualizes the results 
and exports the Gaussian components of the trained network.

Main Steps:
1. Clear workspace, close figures, and set random seed for reproducibility.
2. Add the IGMN library to the MATLAB path.
3. Generate input and output data for the regression task.
4. Define the maximum number of Gaussian components (`maxNc`).
5. Create a `Problem` object to configure the regression task, including:
    - Input and output data.
    - Execution mode (e.g., 'mex' or 'native').
    - Parameter tuning options.
    - Compilation options for optimization.
6. Configure optimization options for hyperparameter tuning, such as:
    - Algorithm type.
    - Self and social adjustment factors.
    - Population size and parallel execution.
    - Tolerance and stopping criteria.
7. Compile the problem if the execution mode is 'mex' or 'native'.
8. Perform parameter tuning if enabled.
9. Train the IGMN model using the training data.
10. Predict the output for test data and evaluate the results.
11. Visualize the regression results and Gaussian components of the trained network.
12. Export the visualization as a PDF file.

Key Parameters:
- `maxNc`: Maximum number of Gaussian components.
- `ExecutionMode`: Determines whether to use 'mex' or 'native' execution.
- `OptimizeOptions`: Contains settings for hyperparameter optimization.
- `DefaultIgmnOptions`: Default options for the IGMN model.

Visualization:
- Regression results are plotted using `plotregression`.
- Gaussian components are visualized using `plotNet`.

Dependencies:
- The script requires the IGMN library and its associated functions 
  (e.g., `optimize_mex`, `igmnBuilder_mex`, `train_mex`, `predict_mex`).

Output:
- Regression performance visualization.
- Exported PDF file showing the Gaussian components of the trained network.
%}
clear all; %#ok<CLALL> 
close all;
clc;
rng('default');
rng(42);

addpath('../../../igmn/');

inputData = 0:0.01:(2 * pi);
inputData = inputData(randperm(size(inputData, 2)));
outputData = linspace(0, 2 * pi, 100);

maxNc = 7;

problem = Problem( ...
    [inputData; sin(inputData)]', ...
    [outputData; sin(outputData)]', ...
    'ExecutionMode', 'mex', ...
    'DoParametersTuning', false, ...
    'CompileOptions', compileoptions(...
        size(inputData, 2), size(outputData, 2),  ...
        'NumberOfVariables', 2, ...
        'NumberOfOutputVars', 1, ...
        'EnableRecompile', false, ...
        'IsOptimization', true ...
    ));

% problem.OptimizeOptions.PlotFcns = {};
problem.OptimizeOptions.Algorithm = 'imode';
problem.OptimizeOptions.SelfAdjustment = 1.49;
problem.OptimizeOptions.SocialAdjustment = 1.49;
problem.OptimizeOptions.UseDefaultsFor = {'MaxNc', 'UseRankOne'};
% problem.DefaultIgmnOptions.Phi = 1;
problem.OptimizeOptions.MaxFunEval = 100000;
problem.OptimizeOptions.PopulationSize = 30;
problem.OptimizeOptions.UseParallel = true;
problem.OptimizeOptions.StallIterLimit = 200;
problem.OptimizeOptions.TolFunValue = 1e-12;
problem.DefaultIgmnOptions.MaxNc = maxNc;
problem.DefaultIgmnOptions.UseRankOne = 1;
problem.DefaultIgmnOptions.SPMin = 2;
% problem.DefaultIgmnOptions.Delta = 0.1;
problem.OptimizeOptions.hyperparameters{5}.ub = 6;
problem.OptimizeOptions.hyperparameters{5}.lb = 2;

if strcmpi(problem.ExecutionMode, 'mex') || strcmpi(problem.ExecutionMode, 'native') 
    compile(problem);
    if strcmpi(problem.ExecutionMode, 'mex')
        optimize = @optimize_mex;
        igmnBuilder = @igmnBuilder_mex;
        train = @train_mex;
        predict = @predict_mex;
    end
end

if ~strcmpi(problem.ExecutionMode, 'native')
    if problem.DoParametersTuning
        tic;
        igmnOptions = optimize(problem);
        save('igmnOptions', 'igmnOptions');
        toc;
    else
        igmnOptions = load('igmnOptions.mat').igmnOptions;
    end
    
    trainData = problem.trainData;
    testData = problem.testData;    
    inputVarIndexes = problem.InputVarIndexes;
    outputVarIndexes = problem.OutputVarIndexes;
    
    tic;
    net = igmnBuilder(igmnOptions);
    net = train(net, trainData);
    Y = predict(net, testData(:, inputVarIndexes), ...
        outputVarIndexes, 0, zeros(size(net.range(:, outputVarIndexes))));
    toc;
    
    figure; plotregression(testData(:, outputVarIndexes), Y);
    figure;
    scatter(inputData + rand(1, size(inputData, 2)) .* 0.2, ...
        sin(inputData), 'Marker', '.' ,'Color', [0 0.4470 0.7410]);
    plotNet(net, 'sd', 4.5, 'ax', gca, 'sd', 4);
    exportgraphics( ...
        gcf, sprintf('%s.pdf', 'igmn_gaussians'), ...
        'BackgroundColor', 'none', 'Resolution', 300)
end

##### SOURCE END #####
-->
</body>
</html>
